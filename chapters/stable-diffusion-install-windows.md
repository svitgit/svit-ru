# Установка на Windows

Приступим.
Я буду рассматривать процесс установки данной [ветки](https://github.com/AUTOMATIC1111/stable-diffusion-webui) stable diffusion.
Преимущество данной ветки заключается в том, что она позволяет выполнять текстовые запросы через графический интерфейс, реализованный в виде веб-приложения.
Итак, для начала нам понадобится установить:

- Python 3.10.6
- GIT

## Установка Python 3.10.6

Начнём с установки Python-а версии 3.10.6.
Для этого перейдем по следующей ссылке [https://www.python.org/downloads/windows/](https://www.python.org/downloads/windows/).
В описании к этому видео будет прикреплена ссылка на текстовый вариант текущей инструкции со всеми ссылками.
После этого, выбираем среди списка всевозможных версий Python-а ту, что требуется нам.
Затем скачиваем установочный файл (я выбрал версию `64-bit`).
Теперь необходимо запустить скачанный файл.

```{warning}
Важно, перед началом установки убедиться, что опция `Add Python 3.10 to PATH` активирована.
```
Далее, устанавливаем интерпретатор языка Python.
Отлично, с этим шагом мы разобрались.

## Установка GIT

Теперь перейдем к установке программы под названием `GIT`.
При помощи этой программы мы скачаем все необходимые файлы для `stable diffusion`.
Перейдем на следующий сайт: [https://git-scm.com/download/win](https://git-scm.com/download/win).
В моём случае, я выбираю версию `64-bit Git for Windows Setup`.
После того, как загрузочный файл скачан, устанавливаем программу на наш компьютер.
Я оставляю все параметры в процессе установки по-умолчанию.

## Установка Stable Diffusion

Супер.
Теперь мы можем перейти непосредственно к установке Stable Diffusion.
Для этого я предлагаю создать отдельную папку на твоём компьютере.
Далее, нам нужно запустить командную строку в текущей директории.
Для этого замени текущий путь в строке проводника сверху на `cmd`.
Затем нажми enter. После этого должна открыться командная строка.
В командной строке необходимо выполнить следующую команду:
```
git clone https://github.com/AUTOMATIC1111/stable-diffusion-webui.git
```
Данная команда скачает актуальную версию нейросети с сайта github.
Отлично, мы практически добрались до финала.
Нам необходимо перейти в только что скачанную папку и запустить скрипт под названием `webui-user.bat`.
Данный скрипт запустит процесс установки всех python-библиотек, необходимых для работы нейросети.
Этот процесс занимает определенное время.
В конце ты должен увидеть следующее сообщение в консоли:
```{note}
Running on local URL: http://127.0.0.1:7860
```
Последние 4-ре цифры могут слегка отличаться и это не является критичным.
Теперь нам необходимо скопировать данный адрес и вставить его в браузер.
Вот и всё, теперь ты можешь пользоваться stable-diffusion.

## Краткий пример использования сети
Давай в завершении данного эпизода рассмотрим пример использования функции `txt2img`, которая соответствует генерированию изображения по заданному текстовому описанию.
В качестве текстового запроса я буду использовать следующий (я взял первый попавшийся запрос погуглив `stable diffusion prompts`:
```{note}
modelshoot style, Anne Hathaway, (extremely detailed CG unity 8k wallpaper), full shot body photo of the most beautiful artwork in the world, medieval armor, professional majestic oil painting by Ed Blinkey, Atey Ghailan, Studio Ghibli, by Jeremy Mann, Greg Manchess, Antonio Moro, trending on ArtStation, trending on CGSociety, Intricate, High Detail, Sharp focus, dramatic, photorealistic painting art by midjourney and greg rutkowski
```
Ты можешь попробовать придумать свой собственный текстовый запрос.
Однако, часто результаты могут не соответствовать твоим ожиданиям, поэтому легче бывает взять какой-нибудь уже готовый запрос в качестве образца и попытаться слегка его модифицировать.

Теперь просто скопируем данный текстовый запрос в поле `Prompt`.
Также мы можем воспользоваться полем `Negative prompt`.
Тут мы можем указать вещи, которые мы не хотим видеть в картинке, которую сгенерирует сеть.
Я оставлю это поле пустым.

Кратко пробежимся по основным элементам:
- `Sampling steps` - параметр, который отвечает за качество получаемой картинки
- `Width`, `Height` - ширина и высота картинки (для генерации больших картинок может потребоваться большой объем видеопамяти). В моём случае моя карточка 3050 уже не вывозит картинки размером 1024 на 1024.
- `Batch count` и `Batch size` - определяют число картинок для генерации
- `CFG scale` - параметр, который регулирует силу следования текстовому запросу. Чем выше значение, тем сильнее сеть пытается следовать запросу.
- `seed` - позволяет воспроизводить результат сети, так мы можем установить фиксированное значение и получать один и тот же результат при повторных запусках. В случае `seed=-1` каждый запуск сети будет уникальным.

Давай установим `batch count` равным 5 и `sampling steps` равным 50.
Теперь запустим сеть и посмотрим какие результаты мы получим.
Довольно неплохо неправда ли для изображения, сгенерированного с нуля компьютером?
На самом деле можно добиться принципиально других результатов.
Для этого мы можем заменить модель нейросети.
Модель - это ядро нейросети, которое получено за счёт использования определенного набора исходных изображений, которые использовались в процессе тренировки сети.

Давай скачаем следующую модель:
```{note}
https://civitai.com/models/4384/dreamshaper
```
По завершению установки, скачанный файл, необходимо переместить в папку `models/Stable-diffusion`.
Отлично, теперь мы можем пользоваться новой моделью.
Для этого достаточно обновить доступные модели нажав на кнопку refresh в левом верхнем углу.
Давай попробуем повторить наш запрос ещё раз и посмотрим какие результаты мы получим.
Не знаю как ты, но я доволен полученым результатом.
На этом на сегодня всё, но дальше нас ждёт еще парочка интересных примеров использования.

